name: Send SMS on failure
run-name: ${{ github.actor }} wants to sent an SMS
on: [push]
env:
  TOKEN: ${{ secrets.SMS_TOKEN }}
  FROM: ${{ secrets.SMS_FROM }}
  TO: ${{ secrets.SMS_TO }}
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: print envvar, to check mind
        run: echo "${FROM} - ${TO}"
      - name: explicitly fail this job
        run: exit -1
      - name: send sms if failed
        if: failure()
        uses: fjogeleit/http-request-action@v1
        with:
          url: 'https://api.telekom.com/service/sms/v1/messages/'
          method: 'POST'
          customHeaders: '{"Content-Type": "application/x-www-form-urlencoded"}'
          data: "From=$FROM&To=$TO&Body=Build%20failed."
      - name: report success
        if: success()
        run: echo "ðŸŽ‰ success, but why?"
